@use "../../styles/mixins" as *;

.header {
    --nav-right: 60%;
    --multi-level-menu-height: 500px;
    position: relative;
    padding: 20px 0;
    background: var(--header-bg);
    box-shadow: 0 20px 60px 10px var(--header-shadow-bg);

    @include screen(sm) {
        --nav-right: 50%;
    }
}

.header__link {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 20px;
    transition: color, background;
    transition-duration: 0.25s;

    &-text {
        font-size: 1.4rem;
        line-height: 1.4;
    }


    &:hover {
        color: var(--primary-color);
        background: var(--bg-primary-color);
    }

    &:hover>.icon {
        filter: var(--primary-icon-color);
    }
}

.header__inner {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
}


.header-avatar {
    &__img {
        width: 40px;
        height: 40px;
        object-fit: cover;
        border-radius: 50%;
    }
}



.navbar {

    &__inner {
        &:hover {
            .dropdown {
                opacity: 1;
                visibility: visible;
            }

            .header-category {
                color: var(--primary-color); // đổi màu text khi hover để show dropdown
            }
        }
    }

    @include screen(lg) {
        background: var(--header-bg);
        position: fixed;
        top: 0;
        bottom: 0;
        left: -100vw;
        width: calc(100vw - var(--nav-right));
        z-index: 9;
        box-shadow: 0 10px 30px rgba(0, 0, 0, .1);
        transition: left .3s ease;

        &.show {
            left: 0;
        }

        &.show~&__overlay {
            opacity: 1;
            visibility: visible;
        }

        &.show~&__dismiss {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
            transform: none;
        }

        &.show .dropdown {
            opacity: 1;
            visibility: visible;
            left: 0;
            right: 0;
            padding-top: 0;
        }

        &.show .dropdown__inner {
            background-color: transparent;
        }
    }

    @include screen(sm) {
        // width: calc(100vw - 50%);
        --nav-right: 50%;
    }

    &__overlay {
        opacity: 0;
        visibility: hidden;

        @include screen(lg) {
            position: fixed;
            inset: 0;
            z-index: 8;
            transition: opacity, visibility;
            transition-duration: 0.5s;
            background: rgba($color: #000000, $alpha: 0.4);
        }
    }


    &__dismiss {
        position: fixed;
        /* đặt tại mép phải của navbar + 8px (ra ngoài) */
        left: calc(100vw - var(--nav-right) + 12px);
        top: calc(env(safe-area-inset-top, 0) + 12px);

        z-index: 10001; // cao hơn navbar & overlay
        width: 44px;
        height: 44px; // tap target tốt
        display: grid;
        place-items: center;
        background: #fff;
        border: 1px solid #e8e8e8;
        border-radius: 999px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, .12);
        cursor: pointer;

        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        transform: translateX(-8px);
        transition: opacity .2s ease, visibility .2s ease, transform .2s ease;
    }

}



.dropdown {
    opacity: 0;
    visibility: hidden;
    position: absolute;
    left: 129px;
    padding-top: 15px;
    transition: opacity visibility;
    transition-duration: 0.25s;
    z-index: 7;



    &__inner {
        background-color: var(--header-bg);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        position: relative;
        width: 260px;
        height: var(--multi-level-menu-height);

        @include screen(lg) {
            width: 100%;
            height: 100vh;
            overflow-y: auto;
        }

        .dropdown__action {
            border-bottom: 2px solid var(--border-color);
        }

        .dropdown__btn {
            min-width: 100%;
            justify-content: flex-start;
            padding-left: 15px;
        }
    }


}

.header-category {

    &__item {
        padding-right: 5px;

        @include screen(lg) {
            width: 100%;
        }
    }

    .navbar:not(.show) &__item:hover>.header-category__submenu {
        opacity: 1;
        visibility: visible;
    }

    .navbar:not(.show) &__item:has(.header-category__submenu:hover)>.header__link {
        // background: var(--bg-primary-color);
        color: var(--primary-color);
    }

    .navbar:not(.show) &__item:has(.header-category__submenu:hover)>.header__link>.icon {
        filter: var(--primary-icon-color);
    }
}

.header-submenu__heading {
    padding: 10px 20px;
    font-size: 1.6rem;
    line-height: 1.4;
    font-weight: 500;
}


.header__submenu-top {
    padding: 10px 20px;
    display: flex;
    align-items: center;
    background-color: var(--header-menu-top);
    gap: 10px;
    font-size: 1.6rem;
    line-height: 1.4;
}


.header-category__submenu {
    opacity: 0;
    visibility: hidden;
    position: absolute;
    top: 0;
    left: 100%;
    background: var(--header-bg);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: opacity visibility;
    transition-duration: 0.25s;
    width: 260px;
    height: var(--multi-level-menu-height);

    @include screen(lg) {
        position: fixed;
        width: auto;
        inset: 0 60% 0 0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, .1);
        z-index: 10;
        transform: translateX(100%);
        transition: transform .3s ease, opacity .25s, visibility .25s;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        height: 100%;
    }

    @include screen(sm) {
        inset: 0 50% 0 0;
    }


    &-item {
        padding-right: 5px;

    }

    .navbar:not(.show) &-item:hover>.header-topic__submenu {
        opacity: 1;
        visibility: visible;
    }

    .navbar:not(.show) &-item:has(.header-topic__submenu:hover)>.header__link {
        color: var(--primary-color);
    }

    .navbar:not(.show) &-item:has(.header-topic__submenu:hover)>.header__link>.icon {
        filter: var(--primary-icon-color);
    }


}


.header-topic__submenu {
    opacity: 0;
    visibility: hidden;
    position: absolute;
    top: 0;
    left: 100%;
    transition: opacity visibility;
    transition-duration: 0.25s;
    background: var(--header-bg);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    width: 260px;
    height: var(--multi-level-menu-height);

    @include screen(lg) {
        position: fixed;
        inset: 0 60% 0 0;
        width: 100%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, .1);
        z-index: 11;
        transform: translateX(100%);
        transition: transform .3s ease, opacity .25s, visibility .25s;
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        height: 100%;
    }

    @include screen(sm) {
        inset: 0 50% 0 0;
    }

}

@include screen(lg) {
    .header-category__item.is-open>.header-category__submenu {
        transform: translateX(0);
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
    }

    .header-category__submenu-item.is-open>.header-topic__submenu {
        transform: translateX(0);
        opacity: 1;
        visibility: visible;
        pointer-events: auto;
    }

}


.header-left {
    display: flex;
    align-items: center;
    gap: 20px;
}


.header-menu {
    display: flex;
    align-items: center;

    &__icon {
        display: block;
        font-size: 20px;
    }
}


.header-language__icon {
    font-size: 1.8rem;
    display: block;
    filter: brightness(0) saturate(100%) invert(100%) sepia(11%) saturate(179%) hue-rotate(230deg) brightness(110%) contrast(103%);
    // opacity: 0.7;
}


.header-action {
    display: flex;
    align-items: center;
    gap: 20px;

    .header-action__login {
        min-width: 90px;
    }

    @include screen(md) {
        margin-left: auto;
    }

    @include screen(md) {
        gap: 5px;
    }


}

.header-action__search-btn {
    max-width: 30px;
    padding: 0;

    .header-action__search-icon {
        font-size: 24px;
        padding-top: 5px;
    }
}


.header-form__wrapper:has(:not(.show)) .header-form__cancel {
    display: none;
}

.header-form__wrapper {
    @include screen(md) {
        margin-left: auto;
    }

    &.show {
        position: fixed;
        inset: 0;
        padding: 5px;
        background-color: var(--body-bg);
        z-index: 11;

        .header-form {
            display: inline-flex;
            align-items: center;
            width: 100%;
            position: relative;

            &__cancel {
                display: inline-block;
                font-size: 1.4rem;
                height: 30px;
            }
        }
    }
}




.header-form {
    display: flex;
    height: 45px;
    width: var(--header-form-width);

    border: 2px solid var(--header-form-border-color);
    border-radius: 20px;
    transition: border-color 0.2s ease-in-out;



    @include screen(sm) {
        display: none;
    }


    &__input {
        flex: 1;

        &::placeholder {
            font-size: 1.4rem;
        }
    }

    &__icon {
        width: 30px;
        height: 100%;
        opacity: 0.7;
        cursor: pointer;
        transition: opacity .2s ease-in-out;

        &:hover {
            opacity: 1;
        }
    }

    &__btn {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 10px;
    }

    &:focus-within {
        border-color: var(--header-search-border-color);
    }
}